{"name":"GrzanieWorker","type":"virtual_device","properties":{"deviceIcon":0,"categories":"[\"other\"]","currentIcon":"0","log":"","logTemp":"","mainLoop":"\n--Funkcje\nDebug = function ( color, message )\n  fibaro:debug(string.format('<%s style=\"color:%s;\">%s', \"span\", color, message))\nend\n\nChangePiecStatus = function (piecId, newStatus) \n  local status = fibaro:getValue(piecId, \"ui.Label1.value\")\n  Debug(\"white\", \"Current status: \" ..status);\n  if (status ~= newStatus)\n    then\n    \tif (newStatus == \"ON\")\n      \t\tthen\n      \t\tDebug(\"orange\",\"Piec ON\")\n      \t\tfibaro:call(piecId, \"pressButton\", 2)\n      \tend\n    \tif (newStatus == \"OFF\")\n      \t\tthen\n      \t\tDebug(\"orange\",\"Piec OFF\")\n      \t\tfibaro:call(piecId, \"pressButton\", 3)\n      \tend\n    \n    fibaro:debug(\"Changing piec status. New status: \" .. newStatus);\n    end\nend\n\n--Variables\nlocal TermostatVdId = 89\nlocal TargetVsCurrent = tonumber(fibaro:getValue( TermostatVdId , \"ui.Label9.value\" ))\n\nlocal PiecVdId = 87\nlocal PiecStatus = fibaro:getValue(87, \"ui.Label1.value\")\n\n\n--Main--\nDebug(\"white\", TargetVsCurrent)\nif (TargetVsCurrent < 1.03)\n\tthen\n      \tDebug(\"green\", \"Wylaczam pompę\");\n    \tChangePiecStatus(PiecVdId, \"OFF\")\nend\n--if it equals to one it will keep previous state\n\nif (TargetVsCurrent > 1.03)\n\tthen\n      \tDebug(\"green\",  \"Wlaczam pompę\");\n    \tChangePiecStatus(PiecVdId, \"ON\")\nend\n\n","visible":"true","rows":[{"type":"button","elements":[{"id":1,"lua":false,"waitForResponse":false,"caption":"1","name":"Button11","empty":false,"msg":"String to send","buttonIcon":0,"favourite":false,"main":false},{"id":2,"lua":false,"waitForResponse":false,"caption":"2","name":"Button12","empty":false,"msg":"String to send","buttonIcon":0,"favourite":false,"main":false}]}]},"actions":{"pressButton":1,"setSlider":2,"setProperty":2}}